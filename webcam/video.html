<!DOCTYPE html>
<meta charset="utf-8">
<link rel="stylesheet" href="../css/style.css">

<body>
	<div style='display:flex'>
		<div style='justify-content:flex-start'>
			<!-- VIDEO AND CANVAS -->
			<div>
				<video id='video' autoplay='true' style='display:block'></video>
			</div>
		</div>
		<div style='justify-content:flex-start'>
			<!-- VIDEO SOURCE CHOOSER -->
			<div class="select" style='margin-left:5px; padding:5px;'>
				<label for="videoSource">Video source: </label>
				<select id="videoSource"></select>
			</div>
		</div>
	</div>

	<script src='https://code.jquery.com/jquery-latest.min.js'></script>
	<script src='js/video-utils.js'></script>

	<script>
		console.log('==VERSION 5.2');

		const videoScaler = 0.8;
		const videoSelect = document.querySelector('select#videoSource');
		const video = document.getElementById('video');

		document.addEventListener("DOMContentLoaded", function(event) {
			findCameras(videoSelect, video, function(err, stream) {
				if (err)
					alert('VIDEO INITIALIZATION FAILED: ' + err.name + ' ' + JSON.stringify(err));
				else 
					resizeVideo();
			});
		});

		function resizeVideo() {
			if (video.videoWidth/video.videoHeight > screen.width/screen.height) {
				video.width = screen.width * videoScaler;
				video.height = video.width*video.videoHeight/video.videoWidth;
			}
			else {
				video.height = screen.height * videoScaler;
				video.width = video.height*video.videoWidth/video.videoHeight;
			}
		}
	</script>
